<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asisten Kesehatan Digital - Terhubung Data Live</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* slate-900 */
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            transition: background-image 1s ease-in-out;
        }
        .card-enter {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .active-glow {
            box-shadow: 0 0 15px rgba(20, 184, 166, 0.5), 0 0 5px rgba(20, 184, 166, 0.7);
        }
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid #334155; /* slate-700 */
            border-bottom-color: #14b8a6; /* teal-500 */
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .drug-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        }
        .neon-glow {
            transform: scale(1.03);
            box-shadow: 0 10px 30px rgba(20, 184, 166, 0.4);
            border-color: #14b8a6;
        }
    </style>
</head>
<body class="text-slate-300">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <!-- Header Section -->
        <header class="text-center mb-8 md:mb-12">
             <div class="flex justify-center items-center gap-3 text-teal-400 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z" />
                </svg>
                <h1 class="text-3xl md:text-5xl font-bold text-white">Asisten Kesehatan Digital</h1>
             </div>
            <p class="mt-3 text-lg text-slate-400">Temukan obat yang tepat untuk keluhan Anda.</p>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Filter & Search Section -->
            <div class="bg-slate-800/80 backdrop-blur-sm border border-slate-700 p-6 rounded-2xl shadow-lg mb-8 z-10">
                <div class="mb-5">
                    <label class="block text-xl font-semibold text-white mb-3">Apa yang Anda rasakan?</label>
                    <div id="category-buttons" class="flex flex-wrap gap-3">
                        <!-- Category buttons will be inserted here by JS -->
                    </div>
                </div>
                <div>
                    <label for="search-input" class="block text-lg font-medium text-slate-200 mb-2">Atau cari nama obat...</label>
                    <input type="text" id="search-input" placeholder="Contoh: Parasetamol, Flucadex..." class="w-full px-4 py-3 bg-slate-700 border border-slate-600 text-white rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition duration-300 placeholder-slate-400">
                </div>
            </div>

            <!-- Results Section -->
            <div id="results-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Initial Loading State -->
                <div id="loading-state" class="col-span-full text-center py-16">
                    <div class="loader mx-auto"></div>
                    <p class="mt-4 text-slate-400">Mengambil data obat terbaru...</p>
                </div>
                <!-- Medicine cards will be inserted here by JS -->
            </div>
            
            <!-- No Results Message -->
            <div id="no-results" class="hidden text-center py-16 col-span-full">
                <svg class="mx-auto h-12 w-12 text-slate-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path>
                </svg>
                <h3 class="mt-2 text-xl font-medium text-white">Obat tidak ditemukan</h3>
                <p class="mt-1 text-slate-400">Coba gunakan kata kunci lain atau pilih kategori yang berbeda.</p>
            </div>
        </main>

        <!-- Footer -->
        <footer class="text-center mt-12 py-6 border-t border-slate-800">
            <p class="text-slate-500">&copy; 2024 Asisten Kesehatan Digital. Informasi ini bukan pengganti nasihat medis profesional.</p>
        </footer>

    </div>

    <script>
        // --- GLOBAL VARIABLES & CONSTANTS ---
        let medicines = []; // Akan diisi dengan data dari Google Apps Script
        
        // --- PERUBAHAN: URL langsung ke Google Apps Script ---
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwfNRD98XtqGjr_6uoflO3u2n51ybu-gbRYry0mSfC8nLYIDijW5MehLqMhFRMlW4C-/exec';

        // --- DATABASE INTERNAL UNTUK INFORMASI DETAIL (TETAP SAMA) ---
        const drugUsageInfo = {
            'bintamox': { kegunaan: 'Untuk infeksi bakteri umum, seperti sakit gigi, radang tenggorokan karena bakteri, infeksi telinga, atau infeksi kulit.' },
            'samquinor': { kegunaan: 'Untuk infeksi bakteri yang lebih kuat, seperti infeksi saluran kemih, infeksi pencernaan, atau infeksi tulang dan sendi.' },
            'yusimox': { kegunaan: 'Untuk infeksi bakteri umum, seperti sakit gigi, radang tenggorokan karena bakteri, infeksi telinga, atau infeksi kulit.' },
            'methylprednisolone': { kegunaan: 'Meredakan peradangan (bengkak, nyeri) dan reaksi alergi berat, misalnya pada asma akut, radang sendi, atau alergi kulit parah.' },
            'molacort': { kegunaan: 'Meredakan peradangan (bengkak, nyeri) dan reaksi alergi berat, misalnya pada asma akut, radang sendi, atau alergi kulit parah.' },
            'degirol': { kegunaan: 'Sebagai antiseptik untuk melegakan sakit tenggorokan, sariawan, atau radang gusi dengan cara membunuh kuman di mulut.' },
            'cetirizine hcl': { kegunaan: 'Meredakan gejala alergi seperti hidung meler, bersin-bersin, mata berair, dan gatal-gatal pada kulit atau biduran.' },
            'brochifar': { kegunaan: 'Membantu mengencerkan dahak yang kental di tenggorokan, sehingga lebih mudah dikeluarkan saat batuk (untuk batuk berdahak).' },
            'flucadex': { kegunaan: 'Meredakan paket gejala flu, seperti demam, sakit kepala, hidung tersumbat, dan bersin-bersin.' },
            'roverton': { kegunaan: 'Membantu mengencerkan dahak yang kental di tenggorokan, sehingga lebih mudah dikeluarkan saat batuk (untuk batuk berdahak).' },
            'ambrochloride': { kegunaan: 'Membantu mengencerkan dahak yang kental di tenggorokan, sehingga lebih mudah dikeluarkan saat batuk (untuk batuk berdahak).' },
            'molexflu pe': { kegunaan: 'Meredakan paket gejala flu, seperti demam, sakit kepala, hidung tersumbat, dan bersin-bersin.' },
            'flutrop': { kegunaan: 'Meredakan paket gejala flu, seperti demam, sakit kepala, hidung tersumbat, dan bersin-bersin.' },
            'tusif': { kegunaan: 'Meredakan batuk, baik yang kering (tidak berdahak) maupun yang disertai sedikit dahak.' },
            'tidak bernama': { kegunaan: 'Meredakan gejala flu umum yang disertai dengan batuk.' },
            'ranitidine hcl': { kegunaan: 'Mengurangi produksi asam lambung berlebih. Cocok untuk keluhan maag, GERD (asam lambung naik), dan perut kembung.' },
            'diapet': { kegunaan: 'Membantu memadatkan tinja dan mengurangi frekuensi buang air besar saat diare, bukan untuk membunuh bakteri penyebabnya.' },
            'antasida': { kegunaan: 'Menetralkan asam lambung secara cepat untuk meredakan nyeri ulu hati, mual, dan rasa tidak nyaman akibat maag.' },
            'insto': { kegunaan: 'Mengatasi mata merah dan rasa perih akibat iritasi ringan, misalnya karena debu, asap, atau terlalu lama di depan layar.' },
            'parasetamol': { kegunaan: 'Pilihan pertama untuk menurunkan demam dan meredakan nyeri ringan hingga sedang, seperti sakit kepala, sakit gigi, atau nyeri otot.' },
            'anastan forte': { kegunaan: 'Meredakan nyeri ringan hingga sedang, efektif untuk sakit gigi, nyeri haid, atau nyeri setelah operasi kecil.' },
            'mixalgin': { kegunaan: 'Untuk meredakan nyeri yang cukup kuat, seperti sakit kepala hebat, migrain, nyeri sendi, atau nyeri saraf.' },
            'bodrex extra': { kegunaan: 'Diformulasikan khusus untuk meredakan sakit kepala tegang yang terasa seperti diikat di sekitar kepala.' },
            'neo rheumacyl neuro': { kegunaan: 'Meredakan nyeri yang disertai rasa kebas, kesemutan, atau kram, karena mengandung vitamin untuk saraf.' },
            'neuralgin': { kegunaan: 'Untuk meredakan nyeri yang cukup kuat, seperti sakit kepala hebat, migrain, nyeri sendi, atau nyeri saraf.' },
            'spasminal': { kegunaan: 'Meredakan nyeri perut yang disebabkan oleh kram atau kejang otot perut, misalnya saat menstruasi atau gangguan pencernaan.' },
            'opistan': { kegunaan: 'Meredakan nyeri ringan hingga sedang, efektif untuk sakit gigi, nyeri haid, atau nyeri setelah operasi kecil.' },
            'becom-c': { kegunaan: 'Suplemen untuk menjaga daya tahan tubuh, membantu proses penyembuhan, dan memenuhi kebutuhan vitamin B kompleks dan C.' },
            'vit c ipi jeruk': { kegunaan: 'Suplemen untuk menjaga daya tahan tubuh, membantu proses penyembuhan, dan memenuhi kebutuhan vitamin C.' }
        };

        const drugDosageInfo = {
            'bintamox': { dosis: '1 kaplet (500 mg) 3 kali sehari', aturan: 'Dapat diminum sebelum atau sesudah makan.', max: 'Sesuai resep dokter' },
            'samquinor': { dosis: '1 kaplet (500 mg) 2 kali sehari', aturan: 'Dapat diminum sebelum atau sesudah makan.', max: 'Sesuai resep dokter' },
            'yusimox': { dosis: '1 kaplet (500 mg) 3 kali sehari', aturan: 'Dapat diminum sebelum atau sesudah makan.', max: 'Sesuai resep dokter' },
            'methylprednisolone': { dosis: '4-48 mg per hari, tergantung kondisi', aturan: 'Harus sesudah makan.', max: 'Sesuai resep dokter' },
            'molacort': { dosis: 'Dosis disesuaikan oleh dokter', aturan: 'Harus sesudah makan.', max: 'Sesuai resep dokter' },
            'degirol': { dosis: '1 tablet isap setiap 3-4 jam', aturan: 'Diisap perlahan, jangan dikunyah.', max: '8 tablet per hari' },
            'cetirizine hcl': { dosis: '1 tablet (10 mg) 1 kali sehari', aturan: 'Dapat diminum sebelum atau sesudah makan.', max: '1 tablet per hari' },
            'brochifar': { dosis: '1 kaplet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 kaplet per hari' },
            'flucadex': { dosis: '1 kaplet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 kaplet per hari' },
            'roverton': { dosis: '1 tablet (30 mg) 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 tablet per hari' },
            'ambrochloride': { dosis: '1 tablet (30 mg) 2-3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 tablet per hari' },
            'molexflu pe': { dosis: '1 kaplet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 kaplet per hari' },
            'flutrop': { dosis: '1 kaplet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 kaplet per hari' },
            'tusif': { dosis: '1-2 kaplet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '6 kaplet per hari' },
            'tidak bernama': { dosis: '1 tablet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 tablet per hari' },
            'ranitidine hcl': { dosis: '1 tablet (150 mg) 2 kali sehari', aturan: 'Dapat diminum sebelum atau sesudah makan.', max: 'Sesuai resep dokter' },
            'diapet': { dosis: '2 kapsul setelah buang air besar', aturan: 'Maksimal 6 kapsul dalam 24 jam.', max: '6 kapsul per hari' },
            'antasida': { dosis: '1-2 tablet, 3-4 kali sehari', aturan: 'Dikunyah 1 jam sebelum makan atau 2 jam sesudah makan.', max: '8 tablet per hari' },
            'insto': { dosis: '1-2 tetes pada setiap mata', aturan: 'Teteskan pada mata yang sakit.', max: '3-4 kali sehari' },
            'parasetamol': { dosis: '1-2 kaplet (500-1000 mg) setiap 4-6 jam', aturan: 'Dapat diminum sebelum atau sesudah makan.', max: '8 kaplet per hari' },
            'anastan forte': { dosis: '1 kaplet (500 mg) 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 kaplet per hari' },
            'mixalgin': { dosis: '1 kaplet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 kaplet per hari' },
            'bodrex extra': { dosis: '1-2 kaplet 3-4 kali sehari', aturan: 'Diminum sesudah makan.', max: '8 kaplet per hari' },
            'neo rheumacyl neuro': { dosis: '1 kaplet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 kaplet per hari' },
            'neuralgin': { dosis: '1 kaplet 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '4 kaplet per hari' },
            'spasminal': { dosis: '1-2 kaplet 3 kali sehari', aturan: 'Dapat diminum sebelum atau sesudah makan.', max: '6 kaplet per hari' },
            'opistan': { dosis: '1 kaplet (500 mg) 3 kali sehari', aturan: 'Diminum sesudah makan.', max: '3 kaplet per hari' },
            'becom-c': { dosis: '1 kaplet 1 kali sehari', aturan: 'Diminum sesudah makan.', max: '1 kaplet per hari' },
            'vit c ipi jeruk': { dosis: '1-2 tablet isap per hari', aturan: 'Dihisap sesudah makan.', max: '2 tablet per hari' }
        };

        // --- DOM ELEMENTS ---
        const resultsContainer = document.getElementById('results-container');
        const searchInput = document.getElementById('search-input');
        const noResultsMessage = document.getElementById('no-results');
        const categoryButtonsContainer = document.getElementById('category-buttons');
        const loadingState = document.getElementById('loading-state');
        
        // --- CONSTANTS FOR STYLING ---
        const ACTIVE_BUTTON_CLASSES = ['active-glow', 'bg-teal-500', 'text-white'];
        const INACTIVE_BUTTON_CLASSES = ['bg-slate-700', 'text-slate-200', 'hover:bg-slate-600'];

        async function fetchMedicineData() {
            try {
                // --- PERUBAHAN: Fetch langsung ke URL script dan mengharapkan JSON ---
                const response = await fetch(SCRIPT_URL);
                if (!response.ok) throw new Error(`Network response was not ok: ${response.statusText}`);
                const jsonData = await response.json();
                // --- PERUBAHAN: Memanggil fungsi baru untuk memproses JSON ---
                return processJSON(jsonData);
            } catch (error) {
                console.error("Gagal mengambil data obat:", error);
                loadingState.classList.add('hidden');
                resultsContainer.innerHTML = `<div class="col-span-full text-center py-16 bg-slate-800 rounded-lg"><h3 class="text-xl font-medium text-red-400">Gagal Memuat Data</h3><p class="mt-1 text-slate-400">Tidak dapat terhubung ke database obat. Periksa koneksi internet Anda atau coba lagi nanti.</p></div>`;
                return [];
            }
        }

        // --- FUNGSI BARU: Untuk memproses data JSON dari Google Apps Script ---
        function processJSON(data) {
            // Data dari Apps Script adalah array of objects
            return data.map(entry => {
                const newEntry = {
                    // Mapping nama field dari JSON ke nama yang digunakan di aplikasi
                    kategori: entry.Kategori,
                    nama: entry.Nama_Obat,
                    stok: entry.Stok_Obat,
                    kegunaan_asli: entry.Kegunaan_Obat 
                };

                const drugNameLower = (newEntry.nama || '').toLowerCase();
                
                // Menggunakan kembali logika yang ada untuk menggabungkan info detail
                const useInfo = drugUsageInfo[drugNameLower];
                newEntry.kegunaan = useInfo ? useInfo.kegunaan : (newEntry.kegunaan_asli || 'Informasi tidak tersedia.');
                
                const dosageInfo = drugDosageInfo[drugNameLower];
                if (dosageInfo) {
                    newEntry.dosis = dosageInfo.dosis;
                    newEntry.aturan = dosageInfo.aturan;
                    newEntry.max = dosageInfo.max;
                } else {
                    newEntry.dosis = 'Hubungi apoteker';
                    newEntry.aturan = 'Hubungi apoteker';
                    newEntry.max = 'Hubungi apoteker';
                }
                delete newEntry.kegunaan_asli; // Menghapus field sementara
                return newEntry;
            }).filter(entry => entry.nama && entry.nama.trim() !== ''); // Filter entri kosong
        }


        function displayMedicines(medicineList) {
            loadingState.classList.add('hidden');
            resultsContainer.innerHTML = '';
            noResultsMessage.classList.toggle('hidden', medicineList.length > 0);
            if(medicineList.length > 0) resultsContainer.appendChild(noResultsMessage);

            medicineList.forEach((med, index) => {
                const stockTextRaw = String(med.stok || '').toLowerCase();
                const stockNumber = parseInt(stockTextRaw) || 0;

                let stockText, stockClass;

                if (stockTextRaw === 'stok habis' || stockNumber === 0) {
                    stockText = 'Stok Habis';
                    stockClass = 'text-red-400 bg-red-900/50';
                } else if (stockNumber > 0 && stockNumber <= 10) {
                    stockText = med.stok;
                    stockClass = 'text-yellow-400 bg-yellow-900/50';
                } else if (stockNumber > 10) {
                    stockText = med.stok;
                    stockClass = 'text-green-400 bg-green-900/50';
                } else {
                    stockText = 'Stok Belum Diketahui';
                    stockClass = 'text-slate-400 bg-slate-700';
                }

                const card = document.createElement('div');
                card.className = "drug-card card-enter bg-slate-800 rounded-2xl shadow-md overflow-hidden border border-slate-700 hover:border-teal-500 hover:shadow-2xl hover:shadow-teal-500/10";
                card.style.animationDelay = `${index * 50}ms`;
                
                card.addEventListener('click', (e) => {
                    if (e.target.tagName === 'A' || e.target.parentElement.tagName === 'A') return;

                    const currentlyGlowing = document.querySelector('.neon-glow');
                    if (currentlyGlowing && currentlyGlowing !== card) {
                        currentlyGlowing.classList.remove('neon-glow');
                    }
                    card.classList.toggle('neon-glow');
                });

                card.innerHTML = `
                    <div class="p-6 flex flex-col h-full">
                        <div>
                            <div class="flex justify-between items-start mb-3">
                                <span class="text-sm font-medium text-teal-300 bg-teal-900/50 px-3 py-1 rounded-full">${med.kategori}</span>
                                <span class="text-sm font-semibold ${stockClass} px-3 py-1 rounded-full">${stockText}</span>
                            </div>
                            <h2 class="text-2xl font-bold text-white mb-2">${med.nama}</h2>
                            <p class="text-slate-400 mb-5 flex-grow">${med.kegunaan}</p>
                            <div class="space-y-3 text-sm border-t border-slate-700 pt-4">
                                <p><strong class="font-semibold text-slate-300 w-28 inline-block">Dosis:</strong> ${med.dosis}</p>
                                <p><strong class="font-semibold text-slate-300 w-28 inline-block">Aturan Pakai:</strong> ${med.aturan}</p>
                                <p><strong class="font-semibold text-slate-300 w-28 inline-block">Max/Hari:</strong> ${med.max}</p>
                            </div>
                        </div>
                        <div class="mt-5 pt-4 border-t border-slate-700">
                             <a href="https://forms.gle/4KLxzG7XA2HM5ecb6" target="_blank" class="block w-full text-center bg-teal-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-teal-600 transition-colors duration-300">
                                Ambil Obat
                             </a>
                        </div>
                    </div>`;
                resultsContainer.appendChild(card);
            });
        }
        
        function createCategoryButtons() {
            const categoryMap = {
                'Pereda Nyeri': ['Sakit Kepala', 'Nyeri'], 'Obat Flu & Batuk': ['Flu & Batuk'], 'Obat Lambung': ['Masalah Lambung', 'Diare'], 'Penurun Demam': ['Demam'], 'Obat Alergi': ['Alergi'], 'Antiseptik': ['Sakit Tenggorokan'], 'Obat Mata': ['Sakit Mata'], 'Vitamin & Suplemen': ['Vitamin'], 'Antibiotik': ['Infeksi (Resep)'], 'Anti-inflamasi': ['Radang (Resep)']
            };
            
            let buttonsHTML = `<button data-filter="all" class="cat-button px-4 py-2 rounded-lg font-semibold transition-all shadow-md">Semua</button>`;
            const displayedCategories = new Set();
            Object.keys(categoryMap).forEach(cat => {
                categoryMap[cat].forEach(symptom => {
                    if (!displayedCategories.has(symptom)) {
                         buttonsHTML += `<button data-filter="${cat}" class="cat-button px-4 py-2 rounded-lg font-semibold transition-all">${symptom}</button>`;
                         displayedCategories.add(symptom);
                    }
                });
            });
            
            categoryButtonsContainer.innerHTML = buttonsHTML;
            const buttons = document.querySelectorAll('.cat-button');
            buttons.forEach(button => {
                if (button.dataset.filter === 'all') button.classList.add(...ACTIVE_BUTTON_CLASSES);
                else button.classList.add(...INACTIVE_BUTTON_CLASSES);
                
                button.addEventListener('click', () => {
                    buttons.forEach(btn => btn.classList.remove(...ACTIVE_BUTTON_CLASSES) || btn.classList.add(...INACTIVE_BUTTON_CLASSES));
                    button.classList.add(...ACTIVE_BUTTON_CLASSES);
                    button.classList.remove(...INACTIVE_BUTTON_CLASSES);
                    const filter = button.getAttribute('data-filter');
                    searchInput.value = '';
                    const filtered = (filter === 'all') ? medicines : medicines.filter(med => med.kategori === filter);
                    displayMedicines(filtered);
                });
            });
        }

        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filteredMedicines = medicines.filter(med =>
                (med.nama || '').toLowerCase().includes(searchTerm) ||
                (med.kegunaan || '').toLowerCase().includes(searchTerm)
            );
            displayMedicines(filteredMedicines);
            
            document.querySelectorAll('.cat-button').forEach(button => {
                button.classList.remove(...ACTIVE_BUTTON_CLASSES);
                button.classList.add(...INACTIVE_BUTTON_CLASSES);
                if (button.dataset.filter === 'all') {
                    button.classList.add(...ACTIVE_BUTTON_CLASSES);
                    button.classList.remove(...INACTIVE_BUTTON_CLASSES);
                }
            });
        });

        document.addEventListener('DOMContentLoaded', async () => {
            const backgrounds = [ 'https://placehold.co/1920x1080/0f172a/334155?text=Background+1', 'https://placehold.co/1920x1080/0f172a/334155?text=Background+2', 'https://placehold.co/1920x1080/0f172a/334155?text=Background+3', 'https://placehold.co/1920x1080/0f172a/334155?text=Background+4', 'https://placehold.co/1920x1080/0f172a/334155?text=Background+5' ];
            let currentBgIndex = 0;

            function changeBackground() {
                const overlay = 'linear-gradient(rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.85))';
                document.body.style.backgroundImage = `${overlay}, url('${backgrounds[currentBgIndex]}')`;
                currentBgIndex = (currentBgIndex + 1) % backgrounds.length;
            }

            changeBackground();
            setInterval(changeBackground, 5000);

            medicines = await fetchMedicineData();
            if (medicines.length > 0) {
                createCategoryButtons();
                displayMedicines(medicines);
            }
        });
    </script>
</body>
</html>
